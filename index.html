<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å±±æ°´è—å»Š Â· å·”å³°å ±åƒ¹ç³»çµ±</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root { --ink: #2c3e50; --paper: #f4f1ea; }
        body { font-family: 'Noto Serif TC', serif; background-color: var(--paper); color: var(--ink); -webkit-tap-highlight-color: transparent; transition: background 0.5s; }
        .landscape-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at 50% 10%, #fff 0%, transparent 60%), linear-gradient(to bottom, var(--paper) 0%, #e5e7eb 100%); opacity: 0.8; }
        .mountain { position: fixed; bottom: 0; left: 0; width: 100%; height: 35vh; background: #94a3b8; clip-path: polygon(0% 100%, 20% 50%, 40% 85%, 60% 30%, 85% 70%, 100% 45%, 100% 100%); opacity: 0.1; z-index: -1; animation: float 15s infinite alternate ease-in-out; }
        @keyframes float { from { transform: translateY(0); } to { transform: translateY(15px); } }
        .xuan-panel { background: rgba(255, 255, 255, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.3); border-radius: 2rem; }
        input { background: transparent !important; border-bottom: 1px solid #cbd5e1 !important; border-radius: 0 !important; font-weight: 900; transition: all 0.4s; }
        input:focus { border-bottom-color: var(--ink) !important; transform: translateY(-2px); }
        .ink-range { -webkit-appearance: none; width: 100%; height: 1px; background: #cbd5e1; }
        .ink-range::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; background: var(--ink); border-radius: 50%; border: 2px solid var(--paper); box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        #settings-drawer { transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1); transform: translateX(100%); }
        #settings-drawer.open { transform: translateX(0); }
        .receipt-mode { background: #fff !important; }
        .receipt-mode .no-print, .receipt-mode .landscape-bg, .receipt-mode .mountain { display: none !important; }
        .receipt-mode .print-only { display: block !important; }
        .print-only { display: none; }
    </style>
</head>
<body class="min-h-screen pb-32">
    <div class="landscape-bg"></div>
    <div class="mountain"></div>
    <nav class="p-8 flex justify-between items-center no-print">
        <h1 class="text-2xl font-black italic tracking-tighter">å±±æ°´ Â· è—å»Š</h1>
        <button onclick="toggleSettings(true)" class="w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center">âš™ï¸</button>
    </nav>
    <div id="settings-drawer" class="fixed inset-0 z-[100] no-print flex justify-end">
        <div class="absolute inset-0 bg-black/10 backdrop-blur-sm" onclick="toggleSettings(false)"></div>
        <div class="relative w-4/5 max-w-sm bg-[#f4f1ea] h-full p-10 shadow-2xl">
            <h2 class="text-xl font-black mb-10">åƒæ•¸è¨­å®š</h2>
            <div class="space-y-6">
                <div><label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2 block">å£“å…‹åŠ›</label><input type="number" id="cfg-price-a" class="w-full p-2 outline-none"></div>
                <div><label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2 block">PS å¡‘è† æ¿</label><input type="number" id="cfg-price-b" class="w-full p-2 outline-none"></div>
                <div><label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2 block">å¡ç´™</label><input type="number" id="cfg-price-c" class="w-full p-2 outline-none"></div>
            </div>
            <button onclick="saveSettings()" class="w-full bg-slate-900 text-white font-bold py-4 rounded-xl mt-12">å„²å­˜è®Šæ›´</button>
        </div>
    </div>
    <main class="max-w-md mx-auto p-6 space-y-8">
        <div class="print-only text-center py-10"><h1 class="text-4xl font-black italic mb-2">QUOTATION</h1><p id="receipt-date" class="text-slate-400 text-[10px] font-bold tracking-widest"></p></div>
        <section class="xuan-panel p-8 space-y-8 no-print">
            <div class="grid grid-cols-2 gap-8">
                <div><label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2 block">é•·åº¦</label><input type="number" id="length" inputmode="decimal" class="w-full text-2xl p-2 outline-none"></div>
                <div><label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2 block">å¯¬åº¦</label><input type="number" id="width" inputmode="decimal" class="w-full text-2xl p-2 outline-none"></div>
                <div class="col-span-2"><label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2 block">æ¡†æ¢å–®åƒ¹</label><input type="number" id="framePrice" inputmode="decimal" class="w-full text-2xl p-2 outline-none"></div>
            </div>
        </section>
        <section class="xuan-panel p-8 no-print">
            <div class="flex justify-between items-center mb-6"><span class="text-[10px] font-bold text-slate-400 tracking-widest">æˆäº¤æŠ˜æ‰£</span><div class="font-black"><input type="number" id="discountInput" value="100" class="w-10 text-right text-xl !p-0"><span class="text-sm ml-1">%</span></div></div>
            <input type="range" id="discountRange" min="30" max="100" value="100" step="5" class="ink-range">
        </section>
        <div class="space-y-6">
            <div class="print-only pb-6 text-center"><p id="receipt-spec" class="text-xl font-black italic border-b border-slate-100 pb-4"></p></div>
            <div class="flex justify-between items-end border-b border-slate-200 pb-4">
                <div><h3 class="font-black text-lg">å£“å…‹åŠ›</h3><p class="text-[9px] text-slate-400 uppercase tracking-widest">Plan A</p></div>
                <div class="text-right"><p id="old-1-2" class="text-[10px] text-slate-300 line-through mb-1"></p><p id="total-1-2" class="text-2xl font-black leading-none">$ 0</p></div>
            </div>
            <div class="flex justify-between items-end border-b border-slate-200 pb-4">
                <div><h3 class="font-black text-lg">PS å¡‘è† æ¿</h3><p class="text-[9px] text-slate-400 uppercase tracking-widest">Plan B</p></div>
                <div class="text-right"><p id="old-1-3" class="text-[10px] text-slate-300 line-through mb-1"></p><p id="total-1-3" class="text-2xl font-black leading-none">$ 0</p></div>
            </div>
            <div class="flex justify-between items-end border-b border-slate-200 pb-4">
                <div><h3 class="font-black text-lg">è—è¡“å¡ç´™</h3><p class="text-[9px] text-slate-400 uppercase tracking-widest">Plan C</p></div>
                <div class="text-right"><p id="old-1-4" class="text-[10px] text-slate-300 line-through mb-1"></p><p id="total-1-4" class="text-2xl font-black leading-none">$ 0</p></div>
            </div>
        </div>
    </main>
    <div class="fixed bottom-10 left-1/2 -translate-x-1/2 w-full px-10 max-w-md no-print">
        <button onclick="toggleReceipt()" class="w-full py-5 bg-slate-900 text-white font-bold rounded-xl shadow-2xl active:scale-95 transition-all flex items-center justify-center space-x-3">
            <span id="btn-icon">ğŸ“„</span> <span id="btn-text" class="text-xs tracking-[0.2em]">è¼¸å‡ºå ±åƒ¹å–®</span>
        </button>
    </div>
    <script>
        let config = { priceA: 150, priceB: 130, priceC: 200 };
        const load = () => {
            const c = localStorage.getItem('g_cfg'); if(c) config = JSON.parse(c);
            ['a','b','c'].forEach(k => document.getElementById(`cfg-price-${k}`).value = config[`price${k.toUpperCase()}`]);
            ['length', 'width', 'framePrice', 'discountRange'].forEach(id => {
                const v = localStorage.getItem(`g_val_${id}`); if(v) document.getElementById(id).value = v;
            });
            calculate();
        };
        const saveSettings = () => {
            ['A','B','C'].forEach(k => config[`price${k}`] = parseFloat(document.getElementById(`cfg-price-${k.toLowerCase()}`).value) || 0);
            localStorage.setItem('g_cfg', JSON.stringify(config)); toggleSettings(false); calculate();
        };
        const calculate = () => {
            const L = parseFloat(document.getElementById('length').value) || 0;
            const W = parseFloat(document.getElementById('width').value) || 0;
            const P = parseFloat(document.getElementById('framePrice').value) || 0;
            const D = parseFloat(document.getElementById('discountRange').value) || 100;
            document.getElementById('discountInput').value = D;
            // å­˜æª”ç•¶å‰æ•¸å€¼
            localStorage.setItem('g_val_length', L); localStorage.setItem('g_val_width', W);
            localStorage.setItem('g_val_framePrice', P); localStorage.setItem('g_val_discountRange', D);
            if (L <= 0 || W <= 0) return;
            const f = (L + W) * 2 * P; const a = L * W;
            const b = [f + (a * config.priceA), f + (a * config.priceB), f + (a * config.priceC)];
            const fmt = (v) => `$ ${Math.round(v).toLocaleString()}`;
            [['total-1-2','old-1-2'],['total-1-3','old-1-3'],['total-1-4','old-1-4']].forEach((id, i) => {
                document.getElementById(id[0]).innerText = fmt(b[i] * (D/100));
                document.getElementById(id[1]).innerText = D < 100 ? fmt(b[i]) : "";
            });
            document.getElementById('receipt-spec').innerText = `${L} Ã— ${W} CM / å–®åƒ¹ $${P}`;
        };
        function toggleSettings(o) { document.getElementById('settings-drawer').classList.toggle('open', o); }
        function toggleReceipt() {
            const r = document.body.classList.toggle('receipt-mode');
            document.getElementById('btn-text').innerText = r ? "è¿”å›ä¿®æ”¹" : "è¼¸å‡ºå ±åƒ¹å–®";
            if(r) { document.getElementById('receipt-date').innerText = new Date().toLocaleDateString('zh-TW', {year:'numeric',month:'long',day:'numeric'}); window.scrollTo(0,0); }
        }
        ['length','width','framePrice','discountRange'].forEach(id => document.getElementById(id).addEventListener('input', calculate));
        window.onload = load;
    </script>
</body>
</html>
