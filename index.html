<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¥µè‡´å±±æ°´ Â· äººæ–‡æ¥µç°¡ç‰ˆ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Noto+Serif+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #F2F2F2; /* æ·ºç°èƒŒæ™¯ */
            --ticket-bg: #FFFFFF;
            --ink: #111111; /* æ¥è¿‘ç´”é»‘ */
            --placeholder: #E0E0E0;
            --line: #E5E5E5;
        }

        body {
            background-color: var(--bg);
            color: var(--ink);
            font-family: 'Inter', sans-serif; /* UI æ–‡å­—ä¿æŒç„¡è¥¯ç·šï¼Œæ¸…æ™°æ˜“è®€ */
            -webkit-font-smoothing: antialiased;
        }

        /* âœ¨ æ ¸å¿ƒä¿®æ”¹ï¼šæ•¸å­—æ”¹ç”¨è¥¯ç·šé«” (Serif) */
        .font-serif-num { 
            font-family: 'Noto Serif TC', serif; 
            letter-spacing: 0.02em; 
        }

        /* è¼¸å…¥å€æ¨£å¼ */
        .input-group {
            margin-bottom: 3rem;
            position: relative;
        }
        
        .raw-input {
            width: 100%;
            background: transparent;
            border: none;
            border-bottom: 1px solid var(--line);
            font-family: 'Noto Serif TC', serif; /* è¼¸å…¥æ•¸å­—ä¹Ÿæ”¹ç‚ºè¥¯ç·š */
            font-size: 2.5rem; 
            font-weight: 500;
            color: var(--ink);
            padding: 0.5rem 0;
            border-radius: 0;
            transition: border-color 0.4s ease;
        }
        
        .raw-input:focus {
            outline: none;
            border-bottom-color: var(--ink);
        }

        .raw-input::placeholder {
            color: var(--placeholder);
            font-weight: 300;
        }

        .label-tiny {
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.08em;
            color: #888;
            margin-bottom: 0.5rem;
            display: block;
            font-family: 'Inter', sans-serif;
            text-transform: uppercase;
        }

        /* å³å´å–®æ“šæ¨£å¼ */
        .ticket {
            background: var(--ticket-bg);
            box-shadow: 0 40px 80px rgba(0,0,0,0.06);
            padding: 3.5rem; /* å¢åŠ ç•™ç™½ */
            position: relative;
            min-height: 640px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        /* å¹½éˆæ•¸æ“šæ¨£å¼ */
        .data-value {
            font-family: 'Noto Serif TC', serif; /* é¡¯ç¤ºæ•¸å­—æ”¹ç‚ºè¥¯ç·š */
            transition: color 0.3s;
        }
        .data-value.empty {
            color: var(--placeholder);
            font-weight: 300;
        }
        .data-value.filled {
            color: var(--ink);
            font-weight: 700;
        }

        /* åƒ¹æ ¼è¡Œ */
        .price-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            padding: 1.5rem 0;
            border-bottom: 1px solid var(--line);
        }
        .price-row:last-child { border-bottom: none; }

        /* Dialog */
        dialog { 
            border: none;
            padding: 0; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border-radius: 4px;
        }
        dialog::backdrop { background: rgba(255,255,255, 0.8); }
        
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="flex flex-col lg:flex-row min-h-screen items-center justify-center p-6 lg:p-0">

    <div class="max-w-6xl w-full grid grid-cols-1 lg:grid-cols-2 gap-16 lg:gap-32">
        
        <!-- å·¦å´ï¼šè¼¸å…¥ (Input) -->
        <div class="flex flex-col justify-center animate-fade-in pl-4 lg:pl-12">
            <header class="mb-16">
                <h1 class="text-5xl font-bold leading-tight tracking-tight mb-2 font-serif-num">
                    æ¥µè‡´å±±æ°´
                </h1>
                <p class="text-gray-400 font-light tracking-widest text-sm">æ•¸ä½å ±åƒ¹ç³»çµ±</p>
            </header>

            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-12">
                    <div class="input-group">
                        <label class="label-tiny">é•·åº¦ (CM)</label>
                        <input type="number" id="length" class="raw-input" placeholder="00">
                    </div>
                    <div class="input-group">
                        <label class="label-tiny">å¯¬åº¦ (CM)</label>
                        <input type="number" id="width" class="raw-input" placeholder="00">
                    </div>
                </div>

                <div class="input-group">
                    <label class="label-tiny">æ¡†æ¢å–®åƒ¹ ($)</label>
                    <input type="number" id="framePrice" class="raw-input" placeholder="0.0">
                </div>
                
                <div class="input-group">
                    <div class="flex justify-between mb-2">
                        <label class="label-tiny">å„ªæƒ æŠ˜æ‰£</label>
                        <span class="font-serif-num text-lg"><span id="discountDisplay">100</span>%</span>
                    </div>
                    <input type="range" id="discountRange" min="50" max="100" value="100" step="5" class="w-full h-[1px] bg-gray-300 appearance-none cursor-pointer accent-black">
                </div>
            </div>

            <div class="mt-12 flex gap-4">
                <button onclick="window.print()" class="bg-black text-white px-8 py-5 text-sm font-bold tracking-widest hover:bg-gray-800 transition-colors w-full flex justify-between items-center group">
                    <span>åˆ—å°å–®æ“š</span>
                    <span class="group-hover:translate-x-1 transition-transform">â†’</span>
                </button>
                <button onclick="toggleSettings()" class="border border-gray-200 px-6 py-5 hover:border-black transition-colors text-gray-400 hover:text-black">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                </button>
            </div>
        </div>

        <!-- å³å´ï¼šå–®æ“š (Receipt) -->
        <div class="flex items-center justify-center">
            <div id="receipt-container" class="ticket w-full max-w-md">
                
                <!-- å–®æ“šé ­éƒ¨ (å·²ç§»é™¤ PROJECT æ¨™é¡Œ) -->
                <div>
                    <div class="flex justify-end mb-10">
                        <div class="text-right">
                            <div class="text-[10px] font-bold uppercase tracking-widest text-gray-400 mb-1">Date</div>
                            <div id="receipt-date" class="font-serif-num text-sm">2026.01.15</div>
                        </div>
                    </div>

                    <!-- è¦æ ¼é¡¯ç¤º -->
                    <div class="bg-gray-50 p-8 mb-12 rounded-sm border border-gray-100">
                        <div class="grid grid-cols-2 gap-8 text-sm">
                            <div>
                                <div class="text-[10px] font-bold uppercase text-gray-400 mb-2">Dimensions</div>
                                <div class="font-serif-num text-xl">
                                    <span id="disp-l" class="data-value empty">00</span> Ã— <span id="disp-w" class="data-value empty">00</span>
                                    <span class="text-xs text-gray-400 ml-1 font-sans">CM</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-[10px] font-bold uppercase text-gray-400 mb-2">Unit Price</div>
                                <div class="font-serif-num text-xl">
                                    $ <span id="disp-p" class="data-value empty">0.0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- åƒ¹æ ¼åˆ—è¡¨ -->
                    <div class="space-y-4">
                        <!-- 1 -->
                        <div class="price-row group">
                            <div>
                                <div class="text-lg font-bold text-gray-900 group-hover:text-black">
                                    <span class="font-serif-num mr-2">1.</span> å£“å…‹åŠ›è£è£±
                                </div>
                                <div class="text-[10px] text-gray-400 font-sans tracking-wide mt-1 pl-6">ACRYLIC GLAZING</div>
                            </div>
                            <div class="text-right">
                                <div id="old-price-a" class="text-[10px] text-gray-300 line-through h-4 font-serif-num"></div>
                                <div class="font-serif-num text-3xl">
                                    $ <span id="price-a" class="data-value empty">00,000</span>
                                </div>
                            </div>
                        </div>
                        <!-- 2 -->
                        <div class="price-row group">
                            <div>
                                <div class="text-lg font-bold text-gray-900 group-hover:text-black">
                                    <span class="font-serif-num mr-2">2.</span> PS å¡‘è† æ¿
                                </div>
                                <div class="text-[10px] text-gray-400 font-sans tracking-wide mt-1 pl-6">POLYSTYRENE</div>
                            </div>
                            <div class="text-right">
                                <div id="old-price-b" class="text-[10px] text-gray-300 line-through h-4 font-serif-num"></div>
                                <div class="font-serif-num text-3xl">
                                    $ <span id="price-b" class="data-value empty">00,000</span>
                                </div>
                            </div>
                        </div>
                        <!-- 3 -->
                        <div class="price-row group">
                            <div>
                                <div class="text-lg font-bold text-gray-900 group-hover:text-black">
                                    <span class="font-serif-num mr-2">3.</span> è—è¡“å¡ç´™
                                </div>
                                <div class="text-[10px] text-gray-400 font-sans tracking-wide mt-1 pl-6">MUSEUM MATBOARD</div>
                            </div>
                            <div class="text-right">
                                <div id="old-price-c" class="text-[10px] text-gray-300 line-through h-4 font-serif-num"></div>
                                <div class="font-serif-num text-3xl">
                                    $ <span id="price-c" class="data-value empty">00,000</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- åº•éƒ¨ç°½ç½²å€ -->
                <div class="mt-16 flex justify-between items-end">
                    <div class="text-[10px] text-gray-400 uppercase tracking-widest">
                        <div>ID <span id="ticket-id" class="font-serif-num ml-1 text-gray-500">000-000</span></div>
                    </div>
                    <div class="w-32 border-b border-black pb-2 text-right">
                        <span class="font-serif-num text-xs font-bold text-black">Shan Shui</span>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- è¨­å®š Modal -->
    <dialog id="settingsDialog" class="w-full max-w-sm">
        <div class="bg-white p-10">
            <h3 class="text-xl font-bold mb-8 font-serif-num">åŸºåƒ¹åƒæ•¸è¨­å®š</h3>
            <div class="space-y-6 text-sm">
                <div>
                    <label class="block mb-2 text-gray-400 font-sans text-xs font-bold tracking-widest">æ–¹æ¡ˆ 1 (å£“å…‹åŠ›)</label>
                    <input type="number" id="cfg-price-a" class="w-full border-b border-gray-200 py-2 focus:outline-none focus:border-black transition-colors text-lg font-serif-num">
                </div>
                <div>
                    <label class="block mb-2 text-gray-400 font-sans text-xs font-bold tracking-widest">æ–¹æ¡ˆ 2 (å¡‘è† æ¿)</label>
                    <input type="number" id="cfg-price-b" class="w-full border-b border-gray-200 py-2 focus:outline-none focus:border-black transition-colors text-lg font-serif-num">
                </div>
                <div>
                    <label class="block mb-2 text-gray-400 font-sans text-xs font-bold tracking-widest">æ–¹æ¡ˆ 3 (è—è¡“å¡ç´™)</label>
                    <input type="number" id="cfg-price-c" class="w-full border-b border-gray-200 py-2 focus:outline-none focus:border-black transition-colors text-lg font-serif-num">
                </div>
            </div>
            <div class="mt-10 flex justify-end gap-6">
                <button onclick="document.getElementById('settingsDialog').close()" class="text-xs font-bold text-gray-400 hover:text-black tracking-widest">å–æ¶ˆ</button>
                <button onclick="saveConfig()" class="bg-black text-white px-8 py-3 text-xs font-bold tracking-widest hover:bg-gray-800">ä¿å­˜è¨­å®š</button>
            </div>
        </div>
    </dialog>

    <script>
        /**
         * ğŸ§  LOGIC ENGINE
         */
        let config = { priceA: 150, priceB: 130, priceC: 200 };

        function initLogic() {
            const savedCfg = localStorage.getItem('g_cfg_pure');
            if(savedCfg) config = JSON.parse(savedCfg);

            ['length', 'width', 'framePrice', 'discountRange'].forEach(id => {
                const val = localStorage.getItem(`g_val_pure_${id}`);
                if(val) document.getElementById(id).value = val;
            });

            // Date
            const d = new Date();
            document.getElementById('receipt-date').innerText = d.toLocaleDateString('en-US', {year:'numeric', month:'2-digit', day:'2-digit'}).replace(/\//g, '.');
            
            // Random Ticket ID
            document.getElementById('ticket-id').innerText = Math.floor(Math.random() * 900000 + 100000);

            calculate();
        }

        // Helper: æ›´æ–°æ•¸å€¼æ¨£å¼
        function updateValue(id, val, isMoney = false) {
            const el = document.getElementById(id);
            if (val > 0) {
                el.innerText = isMoney ? Math.round(val).toLocaleString() : val;
                el.classList.remove('empty');
                el.classList.add('filled');
            } else {
                el.innerText = isMoney ? "00,000" : "00";
                el.classList.add('empty');
                el.classList.remove('filled');
            }
        }

        function calculate() {
            const L = parseFloat(document.getElementById('length').value) || 0;
            const W = parseFloat(document.getElementById('width').value) || 0;
            const P = parseFloat(document.getElementById('framePrice').value) || 0;
            const D = parseFloat(document.getElementById('discountRange').value) || 100;

            localStorage.setItem('g_val_pure_length', L);
            localStorage.setItem('g_val_pure_width', W);
            localStorage.setItem('g_val_pure_framePrice', P);
            localStorage.setItem('g_val_pure_discountRange', D);

            document.getElementById('discountDisplay').innerText = D;
            
            // æ›´æ–° Phantom Data
            updateValue('disp-l', L);
            updateValue('disp-w', W);
            updateValue('disp-p', P, true);

            if (L > 0 && W > 0) {
                const frameTotal = (L + W) * 2 * P; 
                const area = L * W; 
                
                const prices = [
                    frameTotal + (area * config.priceA),
                    frameTotal + (area * config.priceB),
                    frameTotal + (area * config.priceC)
                ];

                const fmt = n => `$ ${Math.round(n).toLocaleString()}`;

                [['price-a','old-price-a'], ['price-b','old-price-b'], ['price-c','old-price-c']].forEach((ids, i) => {
                    const finalPrice = prices[i] * (D/100);
                    // Update final price
                    updateValue(ids[0], finalPrice, true);
                    
                    // Update old price
                    const oldEl = document.getElementById(ids[1]);
                    oldEl.innerText = D < 100 ? fmt(prices[i]) : "";
                });
            } else {
                // Reset prices if input invalid
                updateValue('price-a', 0, true);
                updateValue('price-b', 0, true);
                updateValue('price-c', 0, true);
                document.getElementById('old-price-a').innerText = "";
                document.getElementById('old-price-b').innerText = "";
                document.getElementById('old-price-c').innerText = "";
            }
        }

        function toggleSettings() {
            const d = document.getElementById('settingsDialog');
            if(d.open) d.close(); else {
                ['a','b','c'].forEach(k => {
                    document.getElementById(`cfg-price-${k}`).value = config[`price${k.toUpperCase()}`];
                });
                d.showModal();
            }
        }

        function saveConfig() {
            ['A','B','C'].forEach(k => {
                const val = parseFloat(document.getElementById(`cfg-price-${k.toLowerCase()}`).value);
                if(!isNaN(val)) config[`price${k}`] = val;
            });
            localStorage.setItem('g_cfg_pure', JSON.stringify(config));
            document.getElementById('settingsDialog').close();
            calculate(); 
        }

        ['length','width','framePrice','discountRange'].forEach(id => {
            document.getElementById(id).addEventListener('input', calculate);
        });

        window.addEventListener('DOMContentLoaded', () => {
            // Fade in effect
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 1s ease';
                document.body.style.opacity = '1';
            }, 100);
            initLogic();
        });
    </script>
</body>
</html>
